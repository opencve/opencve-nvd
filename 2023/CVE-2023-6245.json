{
  "configurations": [
    {
      "nodes": [
        {
          "cpeMatch": [
            {
              "criteria": "cpe:2.3:a:dfinity:candid:*:*:*:*:*:rust:*:*",
              "matchCriteriaId": "F95D6602-30FA-4473-9660-F87B18A446FD",
              "versionEndExcluding": "0.9.10",
              "versionStartIncluding": "0.9.0",
              "vulnerable": true
            }
          ],
          "negate": false,
          "operator": "OR"
        }
      ]
    }
  ],
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The Candid library causes a Denial of Service while \nparsing a specially crafted payload with 'empty' data type. For example,\n if the payload is `record { * ; empty }` and the canister interface expects `record { * }` then the Rust candid decoder treats empty as an extra field required by the type.  The problem with the type empty is that the candid Rust library wrongly categorizes empty as a recoverable error when skipping the field and thus causing an infinite decoding loop.\n\n\nCanisters using affected versions of candid\n are exposed to denial of service by causing the decoding to run \nindefinitely until the canister traps due to reaching maximum \ninstruction limit per execution round. Repeated exposure to the payload \nwill result in degraded performance of the canister. Note: Canisters written in Motoko are unaffected.\n\n\n\n"
    },
    {
      "lang": "es",
      "value": "La librería Candid provoca una denegación de servicio mientras analiza un payload especialmente manipulado con un tipo de datos \"vacío\". Por ejemplo, si el payload es `record { * ; empty }` y la interfaz del recipiente espera `record { * }`, entonces el decodificador sincero de Rust trata el vacío como un campo adicional requerido por el tipo. El problema con el tipo vacío es que la sincera librería Rust clasifica erróneamente vacío como un error recuperable al omitir el campo y, por lo tanto, provoca un bucle de decodificación infinito. Los contenedores que utilizan versiones afectadas de candid están expuestos a una denegación de servicio al hacer que la decodificación se ejecute indefinidamente hasta que el contenedor se bloquea debido a que alcanza el límite máximo de instrucciones por ronda de ejecución. La exposición repetida a el payload dará como resultado un rendimiento degradado del recipiente. Nota: Los botes escritos en Motoko no se ven afectados."
    }
  ],
  "id": "CVE-2023-6245",
  "lastModified": "2023-12-13T14:41:10.210",
  "metrics": {
    "cvssMetricV31": [
      {
        "cvssData": {
          "attackComplexity": "LOW",
          "attackVector": "NETWORK",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "privilegesRequired": "NONE",
          "scope": "UNCHANGED",
          "userInteraction": "NONE",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "version": "3.1"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6,
        "source": "nvd@nist.gov",
        "type": "Primary"
      },
      {
        "cvssData": {
          "attackComplexity": "LOW",
          "attackVector": "NETWORK",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "privilegesRequired": "NONE",
          "scope": "UNCHANGED",
          "userInteraction": "NONE",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "version": "3.1"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6,
        "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
        "type": "Secondary"
      }
    ]
  },
  "published": "2023-12-08T15:15:08.233",
  "references": [
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Product"
      ],
      "url": "https://github.com/dfinity/candid/blob/master/spec/Candid.md"
    },
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Patch"
      ],
      "url": "https://github.com/dfinity/candid/pull/478"
    },
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ],
      "url": "https://github.com/dfinity/candid/security/advisories/GHSA-7787-p7x6-fq3j"
    },
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Product"
      ],
      "url": "https://internetcomputer.org/docs/current/references/candid-ref"
    },
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Product"
      ],
      "url": "https://internetcomputer.org/docs/current/references/ic-interface-spec"
    }
  ],
  "sourceIdentifier": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
  "vulnStatus": "Analyzed",
  "weaknesses": [
    {
      "description": [
        {
          "lang": "en",
          "value": "CWE-835"
        }
      ],
      "source": "nvd@nist.gov",
      "type": "Primary"
    },
    {
      "description": [
        {
          "lang": "en",
          "value": "CWE-1288"
        },
        {
          "lang": "en",
          "value": "CWE-168"
        },
        {
          "lang": "en",
          "value": "CWE-20"
        },
        {
          "lang": "en",
          "value": "CWE-835"
        }
      ],
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "type": "Secondary"
    }
  ]
}