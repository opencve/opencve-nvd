{
  "configurations": [
    {
      "nodes": [
        {
          "cpeMatch": [
            {
              "criteria": "cpe:2.3:a:redislabs:redis:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "366C8910-66E7-4AB6-873C-70595AD42ADA",
              "versionEndExcluding": "5.0.11",
              "versionStartIncluding": "4.0",
              "vulnerable": true
            },
            {
              "criteria": "cpe:2.3:a:redislabs:redis:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "C345BCBB-EB73-4DA5-93F0-42AB9E903CE5",
              "versionEndExcluding": "6.0.11",
              "versionStartIncluding": "6.0.0",
              "vulnerable": true
            }
          ],
          "negate": false,
          "operator": "OR"
        }
      ]
    }
  ],
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Redis is an open-source, in-memory database that persists on disk. In affected versions of Redis an integer overflow bug in 32-bit Redis version 4.0 or newer could be exploited to corrupt the heap and potentially result with remote code execution. Redis 4.0 or newer uses a configurable limit for the maximum supported bulk input size. By default, it is 512MB which is a safe value for all platforms. If the limit is significantly increased, receiving a large request from a client may trigger several integer overflow scenarios, which would result with buffer overflow and heap corruption. We believe this could in certain conditions be exploited for remote code execution. By default, authenticated Redis users have access to all configuration parameters and can therefore use the “CONFIG SET proto-max-bulk-len” to change the safe default, making the system vulnerable. **This problem only affects 32-bit Redis (on a 32-bit system, or as a 32-bit executable running on a 64-bit system).** The problem is fixed in version 6.2, and the fix is back ported to 6.0.11 and 5.0.11. Make sure you use one of these versions if you are running 32-bit Redis. An additional workaround to mitigate the problem without patching the redis-server executable is to prevent clients from directly executing `CONFIG SET`: Using Redis 6.0 or newer, ACL configuration can be used to block the command. Using older versions, the `rename-command` configuration directive can be used to rename the command to a random string unknown to users, rendering it inaccessible. Please note that this workaround may have an additional impact on users or operational systems that expect `CONFIG SET` to behave in certain ways."
    },
    {
      "lang": "es",
      "value": "Redis es una base de datos en memoria de código abierto que persiste en el disco.&#xa0;En las versiones afectadas de Redis, un error de desbordamiento de enteros en Redis de 32 bits versión 4.0 o más reciente podría ser explotada para corromper la pila y potencialmente resultar en una ejecución de código remota.&#xa0;Redis versiones 4.0 o posteriores, usa un límite configurable para el tamaño máximo de la entrada masiva admitida.&#xa0;Por defecto, es de 512 MB, que es un valor seguro para todas las plataformas.&#xa0;Si el límite aumenta significativamente, recibir una petición grande de un cliente puede desencadenar varios escenarios de desbordamiento de enteros, que podría resultar en un desbordamiento del búfer y una corrupción de la pila.&#xa0;Creemos que, en determinadas condiciones, esta podría ser explotada para una ejecución de código remota.&#xa0;Por defecto,  usuarios de Redis autenticados poseen acceso a todos los parámetros de configuración y, por lo tanto, pueden usar \"CONFIG SET proto-max-bulk-len\" para cambiar el valor predeterminado seguro,&#xa0;haciendo que el sistema sea vulnerable.** Este problema solo afecta a Redis de 32 bits (en un sistema de 32 bits o como un ejecutable de 32 bits que se ejecuta en un sistema de 64 bits). ** El problema se corrigió en la versión 6.2 y la solución se ha modificado a versiones  6.0.11 y 5.0.11.&#xa0;Asegúrese de usar una de estas versiones si está ejecutando Redis de 32 bits.&#xa0;Una solución alternativa para mitigar el problema sin parchear el ejecutable de redis-server es impedir que los clientes ejecuten directamente `CONFIG SET`: Con Redis versiones 6.0 o más recientes, la configuración de ACL puede ser usada para bloquear el comando.&#xa0;Utilizando versiones anteriores, la directiva de configuración \"rename-command\" puede ser usada para cambiar el nombre del comando a una cadena aleatoria desconocida para usuarios, haciéndolo inaccesible.&#xa0;Tome en cuenta que esta solución puede tener un impacto adicional en los usuarios o los sistemas operativos que esperan que \"CONFIG SET\" se comporte de determinadas formas"
    }
  ],
  "id": "CVE-2021-21309",
  "lastModified": "2022-10-19T13:21:42.343",
  "metrics": {
    "cvssMetricV2": [
      {
        "acInsufInfo": false,
        "baseSeverity": "MEDIUM",
        "cvssData": {
          "accessComplexity": "LOW",
          "accessVector": "NETWORK",
          "authentication": "SINGLE",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.5,
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "version": "2.0"
        },
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "obtainAllPrivilege": false,
        "obtainOtherPrivilege": false,
        "obtainUserPrivilege": false,
        "source": "nvd@nist.gov",
        "type": "Primary",
        "userInteractionRequired": false
      }
    ],
    "cvssMetricV31": [
      {
        "cvssData": {
          "attackComplexity": "LOW",
          "attackVector": "NETWORK",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "privilegesRequired": "LOW",
          "scope": "UNCHANGED",
          "userInteraction": "NONE",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "version": "3.1"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9,
        "source": "nvd@nist.gov",
        "type": "Primary"
      },
      {
        "cvssData": {
          "attackComplexity": "HIGH",
          "attackVector": "NETWORK",
          "availabilityImpact": "LOW",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "privilegesRequired": "NONE",
          "scope": "CHANGED",
          "userInteraction": "NONE",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:L",
          "version": "3.1"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 2.7,
        "source": "security-advisories@github.com",
        "type": "Secondary"
      }
    ]
  },
  "published": "2021-02-26T22:15:19.457",
  "references": [
    {
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ],
      "url": "https://github.com/redis/redis/commit/c992857618db99776917f10bf4f2345a5fdc78b0"
    },
    {
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ],
      "url": "https://github.com/redis/redis/pull/8522"
    },
    {
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ],
      "url": "https://github.com/redis/redis/security/advisories/GHSA-hgj8-vff2-7cjf"
    },
    {
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ],
      "url": "https://security.gentoo.org/glsa/202103-02"
    }
  ],
  "sourceIdentifier": "security-advisories@github.com",
  "vulnStatus": "Analyzed",
  "weaknesses": [
    {
      "description": [
        {
          "lang": "en",
          "value": "CWE-190"
        }
      ],
      "source": "security-advisories@github.com",
      "type": "Primary"
    }
  ]
}