{
  "configurations": [
    {
      "nodes": [
        {
          "cpeMatch": [
            {
              "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "3C2A6657-221F-41B0-8D3D-934B29BF42F9",
              "versionEndIncluding": "6.6.3",
              "versionStartIncluding": "6.0.0",
              "vulnerable": true
            },
            {
              "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "EDBF32B7-D6B4-4373-BBDE-A9BCCC9DA3B1",
              "versionEndIncluding": "7.3.0",
              "versionStartIncluding": "7.0.0",
              "vulnerable": true
            }
          ],
          "negate": false,
          "operator": "OR"
        }
      ]
    }
  ],
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "This vulnerability in Apache Solr 6.0.0 to 6.6.3, 7.0.0 to 7.3.0 relates to an XML external entity expansion (XXE) in Solr config files (solrconfig.xml, schema.xml, managed-schema). In addition, Xinclude functionality provided in these config files is also affected in a similar way. The vulnerability can be used as XXE using file/ftp/http protocols in order to read arbitrary local files from the Solr server or the internal network. Users are advised to upgrade to either Solr 6.6.4 or Solr 7.3.1 releases both of which address the vulnerability. Once upgrade is complete, no other steps are required. Those releases only allow external entities and Xincludes that refer to local files / zookeeper resources below the Solr instance directory (using Solr's ResourceLoader); usage of absolute URLs is denied. Keep in mind, that external entities and XInclude are explicitly supported to better structure config files in large installations. Before Solr 6 this was no problem, as config files were not accessible through the APIs."
    },
    {
      "lang": "es",
      "value": "Esta vulnerabilidad en Apache Solr, de la versión 6.0.0 a la 6.6.3 y de la versión 7.0.0 a la 7.3.0, está relacionada con una expansión XEE (XML External Entity) en los archivos de configuración de Solr (solrconfig.xml, schema.xml y managed-schema). Además, la funcionalidad Xinclude en estos archivos de configuración también se ha visto afectada de forma similar.  La vulnerabilidad puede emplearse como XEE mediante el uso de protocolos file/ftp/http para leer archivos locales arbitrarios del servidor Solr o de la red interna. Se recomienda que los usuarios actualicen a Solr 6.6.4 o Solr 7.3.1, ya que ambos abordan esta vulnerabilidad. Una vez se ha completado la actualización, no se requieren otros pasos. Estas versiones solo permiten entidades externas y Xincludes que se refieran a archivos locales/recursos zookeeper bajo el directorio de la instancia Solr (mediante el uso del ResourceLoader de Solr); no se permite el uso de URL absolutas. Téngase en cuenta que las entidades externas y Xinclude están soportadas explícitamente para estructurar mejor archivos de configuración en instalaciones grandes. En versiones anteriores a Solr 6, esto no era un problema, ya que no se podía acceder a los archivos de configuración mediante las API."
    }
  ],
  "id": "CVE-2018-8010",
  "lastModified": "2023-11-07T03:01:20.797",
  "metrics": {
    "cvssMetricV2": [
      {
        "acInsufInfo": false,
        "baseSeverity": "LOW",
        "cvssData": {
          "accessComplexity": "LOW",
          "accessVector": "LOCAL",
          "authentication": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 2.1,
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "vectorString": "AV:L/AC:L/Au:N/C:P/I:N/A:N",
          "version": "2.0"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 2.9,
        "obtainAllPrivilege": false,
        "obtainOtherPrivilege": false,
        "obtainUserPrivilege": false,
        "source": "nvd@nist.gov",
        "type": "Primary",
        "userInteractionRequired": false
      }
    ],
    "cvssMetricV30": [
      {
        "cvssData": {
          "attackComplexity": "LOW",
          "attackVector": "LOCAL",
          "availabilityImpact": "NONE",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "privilegesRequired": "LOW",
          "scope": "UNCHANGED",
          "userInteraction": "NONE",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "version": "3.0"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6,
        "source": "nvd@nist.gov",
        "type": "Primary"
      }
    ]
  },
  "published": "2018-05-21T19:29:00.203",
  "references": [
    {
      "source": "security@apache.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ],
      "url": "http://www.securityfocus.com/bid/104239"
    },
    {
      "source": "security@apache.org",
      "url": "https://lists.apache.org/thread.html/r204ba2a9ea750f38d789d2bb429cc0925ad6133deea7cbc3001d96b5%40%3Csolr-user.lucene.apache.org%3E"
    },
    {
      "source": "security@apache.org",
      "tags": [
        "Mitigation",
        "Mailing List",
        "Vendor Advisory"
      ],
      "url": "https://mail-archives.apache.org/mod_mbox/www-announce/201805.mbox/%3C08a801d3f0f9%24df46d300%249dd47900%24%40apache.org%3E"
    }
  ],
  "sourceIdentifier": "security@apache.org",
  "vulnStatus": "Modified",
  "weaknesses": [
    {
      "description": [
        {
          "lang": "en",
          "value": "CWE-611"
        }
      ],
      "source": "nvd@nist.gov",
      "type": "Primary"
    }
  ]
}